---
title: "ğŸš€ npm æƒé™é—®é¢˜å®Œå…¨è§£å†³æ–¹æ¡ˆï¼šä»å…¥é—¨åˆ°ç²¾é€š"
date: 2025-10-14 10:00:00
tags: [npm, Node.js, æƒé™ç®¡ç†, Linux, å¼€å‘ç¯å¢ƒ, æ•™ç¨‹]
categories:
  - æŠ€æœ¯
  - Node.js
  - å¼€å‘å·¥å…·
toc: true
pin: false
---

> è¯¦ç»†ä»‹ç»è§£å†³ npm å®‰è£…æƒé™é—®é¢˜çš„å¤šç§æ–¹æ³•ï¼ŒåŒ…æ‹¬ä¸´æ—¶è§£å†³æ–¹æ¡ˆã€æ°¸ä¹…é…ç½®ä¼˜åŒ–ä»¥åŠæœ€ä½³å®è·µå»ºè®®ï¼Œå¸®åŠ©å¼€å‘è€…ä¼˜é›…åœ°å¤„ç† Node.js åŒ…ç®¡ç†æƒé™é—®é¢˜ã€‚

---

## ğŸ“‹ å‰è¨€

åœ¨ä½¿ç”¨ npmï¼ˆNode Package Managerï¼‰è¿›è¡Œå…¨å±€åŒ…å®‰è£…æ—¶ï¼Œå¾ˆå¤šå¼€å‘è€…éƒ½ä¼šé‡åˆ°æƒé™ä¸è¶³çš„é”™è¯¯æç¤ºã€‚è¿™é€šå¸¸æ˜¯å› ä¸ºå°è¯•åœ¨æ²¡æœ‰é€‚å½“æƒé™çš„æƒ…å†µä¸‹å®‰è£…å…¨å±€åŒ…å¯¼è‡´çš„ã€‚æœ¬æ–‡å°†ä¸ºä½ æä¾›å¤šç§è§£å†³æ–¹æ¡ˆï¼Œä»å¿«é€Ÿä¿®å¤åˆ°æœ€ä½³å®è·µï¼Œå¸®åŠ©ä½ å½»åº•è§£å†³è¿™ä¸ªå¸¸è§çš„å¼€å‘ç¯å¢ƒé—®é¢˜ã€‚

---

## ğŸ” é—®é¢˜ç°è±¡

å½“ä½ åœ¨ç»ˆç«¯ä¸­æ‰§è¡Œç±»ä¼¼ä»¥ä¸‹å‘½ä»¤æ—¶ï¼š

```bash
npm install -g @vue/cli
# æˆ–
npm install -g typescript
```

å¯èƒ½ä¼šçœ‹åˆ°ç±»ä¼¼è¿™æ ·çš„é”™è¯¯ä¿¡æ¯ï¼š

```
npm ERR! code EACCES
npm ERR! syscall access
npm ERR! path /usr/local/lib/node_modules/@vue/cli
npm ERR! errno -13
npm ERR! Error: EACCES: permission denied
```

è¿™ä¸ªé”™è¯¯è¯´æ˜å½“å‰ç”¨æˆ·æ²¡æœ‰åœ¨ç³»ç»Ÿç›®å½•ä¸‹å†™å…¥æ–‡ä»¶çš„æƒé™ã€‚

---

## ğŸš€ è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨ sudoï¼ˆä¸´æ—¶æ–¹æ¡ˆï¼‰

è¿™æ˜¯æœ€ç›´æ¥çš„è§£å†³æ–¹æ³•ï¼Œä½†ä¸æ˜¯æ¨èçš„æœ€ä½³å®è·µã€‚

```bash
sudo npm install -g @vue/cli
```

**ä¼˜ç‚¹**ï¼š
- âœ… å¿«é€Ÿç®€å•ï¼Œç«‹å³è§£å†³é—®é¢˜
- âœ… ä¸éœ€è¦é¢å¤–é…ç½®

**ç¼ºç‚¹**ï¼š
- âŒ å®‰å…¨æ€§è¾ƒä½ï¼Œç»™äºˆ npm ç®¡ç†å‘˜æƒé™
- âŒ å¯èƒ½å¯¼è‡´åç»­æƒé™é—®é¢˜
- âŒ ä¸ç¬¦åˆæœ€å°æƒé™åŸåˆ™

> âš ï¸ **æ³¨æ„**ï¼šè™½ç„¶è¿™ç§æ–¹æ³•ç®€å•ï¼Œä½†ä¸æ¨èåœ¨ç”Ÿäº§ç¯å¢ƒä¸­é•¿æœŸä½¿ç”¨ã€‚

---

### æ–¹æ¡ˆäºŒï¼šæ›´æ”¹ npm å…¨å±€åŒ…è·¯å¾„ï¼ˆæ¨èï¼‰

è¿™æ˜¯å®˜æ–¹æ¨èçš„æœ€ä½³å®è·µï¼Œé€šè¿‡ä¿®æ”¹ npm çš„é»˜è®¤å…¨å±€åŒ…å®‰è£…ä½ç½®æ¥é¿å…æƒé™é—®é¢˜ã€‚

#### æ­¥éª¤ 1ï¼šåˆ›å»ºæ–°çš„å…¨å±€åŒ…ç›®å½•

```bash
# åœ¨ç”¨æˆ·ä¸»ç›®å½•ä¸‹åˆ›å»º npm å…¨å±€åŒ…ç›®å½•
mkdir ~/.npm-global
```

#### æ­¥éª¤ 2ï¼šé…ç½® npm ä½¿ç”¨æ–°ç›®å½•

```bash
# è®¾ç½® npm å…¨å±€åŒ…å®‰è£…è·¯å¾„
npm config set prefix '~/.npm-global'
```

#### æ­¥éª¤ 3ï¼šæ›´æ–° PATH ç¯å¢ƒå˜é‡

å°†æ–°çš„ npm å…¨å±€åŒ…è·¯å¾„æ·»åŠ åˆ°ç³»ç»Ÿçš„ PATH ä¸­ï¼š

```bash
# å¯¹äº bash ç”¨æˆ·ï¼ˆå¤§å¤šæ•° Linux å‘è¡Œç‰ˆé»˜è®¤ï¼‰
echo 'export PATH=~/.npm-global/bin:$PATH' >> ~/.bashrc

# å¯¹äº zsh ç”¨æˆ·ï¼ˆmacOS Catalina åŠæ›´é«˜ç‰ˆæœ¬é»˜è®¤ï¼‰
echo 'export PATH=~/.npm-global/bin:$PATH' >> ~/.zshrc

# å¯¹äº fish ç”¨æˆ·
echo 'set -gx PATH ~/.npm-global/bin $PATH' >> ~/.config/fish/config.fish
```

#### æ­¥éª¤ 4ï¼šé‡æ–°åŠ è½½é…ç½®æ–‡ä»¶

```bash
# é‡æ–°åŠ è½½ shell é…ç½®
source ~/.bashrc
# æˆ–
source ~/.zshrc
```

#### æ­¥éª¤ 5ï¼šéªŒè¯é…ç½®

```bash
# æŸ¥çœ‹æ–°çš„å…¨å±€åŒ…è·¯å¾„
npm config get prefix
# åº”è¯¥è¾“å‡ºï¼š/home/yourusername/.npm-global

# æµ‹è¯•å®‰è£…ä¸€ä¸ªåŒ…
npm install -g npm-check-updates

# éªŒè¯å‘½ä»¤æ˜¯å¦å¯ç”¨
which ncu
```

**ä¼˜ç‚¹**ï¼š
- âœ… å®‰å…¨æ€§é«˜ï¼Œä¸éœ€è¦ç®¡ç†å‘˜æƒé™
- âœ… ç¬¦åˆç”¨æˆ·çº§åˆ«çš„åŒ…ç®¡ç†åŸåˆ™
- âœ… é¿å…æƒé™å†²çª
- âœ… ä¾¿äºç®¡ç†å’Œå¤‡ä»½

**ç¼ºç‚¹**ï¼š
- âŒ éœ€è¦åˆå§‹é…ç½®

---

### æ–¹æ¡ˆä¸‰ï¼šä½¿ç”¨ Node Version Managerï¼ˆNVMï¼‰

å¦‚æœä½ ä½¿ç”¨ NVM ç®¡ç† Node.js ç‰ˆæœ¬ï¼Œå¯ä»¥åˆ©ç”¨ NVM çš„ç‰¹æ€§æ¥é¿å…æƒé™é—®é¢˜ã€‚

#### å®‰è£…æˆ–æ›´æ–° NVM

```bash
# å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„ NVM
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash

# æˆ–ä½¿ç”¨ wget
wget -qO- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash

# é‡æ–°åŠ è½½é…ç½®
source ~/.bashrc
```

#### ä½¿ç”¨ NVM ç®¡ç† Node.js å’Œ npm

```bash
# å®‰è£…æœ€æ–° LTS ç‰ˆæœ¬çš„ Node.js
nvm install --lts

# ä½¿ç”¨ç‰¹å®šç‰ˆæœ¬
nvm use 18.17.0

# æ›´æ–° npm åˆ°æœ€æ–°ç‰ˆæœ¬
nvm install-latest-npm

# è®¾ç½®é»˜è®¤ç‰ˆæœ¬
nvm alias default 18.17.0
```

**ä¼˜ç‚¹**ï¼š
- âœ… è‡ªåŠ¨å¤„ç†æƒé™é—®é¢˜
- âœ… æ”¯æŒå¤šç‰ˆæœ¬ Node.js åˆ‡æ¢
- âœ… ç”¨æˆ·çº§åˆ«å®‰è£…
- âœ… ä¾¿äºé¡¹ç›®ç‰ˆæœ¬ç®¡ç†

**ç¼ºç‚¹**ï¼š
- âŒ éœ€è¦é¢å¤–å®‰è£…å’Œé…ç½® NVM

---

## ğŸ”§ é«˜çº§é…ç½®å’Œæœ€ä½³å®è·µ

### 1. é…ç½® npm é•œåƒæº

ä¸ºäº†æé«˜ä¸‹è½½é€Ÿåº¦ï¼Œå¯ä»¥é…ç½® npm ä½¿ç”¨å›½å†…é•œåƒæºï¼š

```bash
# ä½¿ç”¨æ·˜å®é•œåƒ
npm config set registry https://registry.npmmirror.com

# æˆ–ä½¿ç”¨å®˜æ–¹é•œåƒ
npm config set registry https://registry.npmjs.org

# æŸ¥çœ‹å½“å‰é•œåƒæº
npm config get registry
```

### 2. é…ç½® npm å…¨å±€é…ç½®æ–‡ä»¶

åˆ›å»ºæˆ–ç¼–è¾‘ `~/.npmrc` æ–‡ä»¶æ¥æ°¸ä¹…ä¿å­˜é…ç½®ï¼š

```ini
# ~/.npmrc æ–‡ä»¶å†…å®¹
prefix=${HOME}/.npm-global
registry=https://registry.npmmirror.com
cache=${HOME}/.npm-cache
```

### 3. æ‰¹é‡å®‰è£…å¸¸ç”¨åŒ…

```bash
# åˆ›å»ºå¸¸ç”¨åŒ…åˆ—è¡¨
echo "@vue/cli
typescript
nodemon
pm2
eslint
prettier" > ~/npm-packages.txt

# æ‰¹é‡å®‰è£…
xargs npm install -g < ~/npm-packages.txt
```

### 4. è®¾ç½® npm æƒé™ä¿®å¤è„šæœ¬

åˆ›å»ºä¸€ä¸ªä¾¿æ·çš„è„šæœ¬æ¥ä¿®å¤æƒé™é—®é¢˜ï¼š

```bash
# åˆ›å»ºè„šæœ¬æ–‡ä»¶
cat > ~/fix-npm-permissions.sh << 'EOF'
#!/bin/bash

echo "ğŸ”§ ä¿®å¤ npm æƒé™é—®é¢˜..."

# ä¿®å¤ npm ç›®å½•æƒé™
sudo chown -R $(whoami) ~/.npm
sudo chown -R $(whoami) ~/.npm-global

# é‡æ–°åŠ è½½é…ç½®
source ~/.bashrc

echo "âœ… npm æƒé™ä¿®å¤å®Œæˆï¼"
echo "ğŸ“ å½“å‰å…¨å±€åŒ…è·¯å¾„ï¼š$(npm config get prefix)"
EOF

# æ·»åŠ æ‰§è¡Œæƒé™
chmod +x ~/fix-npm-permissions.sh

# è¿è¡Œè„šæœ¬
./fix-npm-permissions.sh
```

---

## ğŸ› ï¸ å¸¸è§é—®é¢˜æ’æŸ¥

### Q1: ä¿®æ”¹é…ç½®åå‘½ä»¤ä»ç„¶ä¸å¯ç”¨

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# æ£€æŸ¥ PATH ç¯å¢ƒå˜é‡
echo $PATH

# æ‰‹åŠ¨æ·»åŠ åˆ°å½“å‰ä¼šè¯
export PATH=~/.npm-global/bin:$PATH

# é‡æ–°å¯åŠ¨ç»ˆç«¯æˆ–é‡æ–°åŠ è½½é…ç½®
source ~/.bashrc
```

### Q2: npm å®‰è£…é€Ÿåº¦å¾ˆæ…¢

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# ä½¿ç”¨ cnpm ä»£æ›¿ npm
npm install -g cnpm --registry=https://registry.npmmirror.com

# æˆ–é…ç½® npm ä½¿ç”¨é•œåƒæº
npm config set registry https://registry.npmmirror.com

# ä½¿ç”¨ yarn ä»£æ›¿ npm
npm install -g yarn
```

### Q3: å…¨å±€åŒ…å®‰è£…åæ‰¾ä¸åˆ°å‘½ä»¤

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# æ£€æŸ¥åŒ…æ˜¯å¦æ­£ç¡®å®‰è£…
npm list -g

# æ£€æŸ¥ PATH è®¾ç½®
echo $PATH | grep -o "[^:]*npm-global[^:]*"

# é‡æ–°åˆ›å»ºç¬¦å·é“¾æ¥
ln -sf ~/.npm-global/bin/* /usr/local/bin/
```

### Q4: æƒé™é—®é¢˜ä¾ç„¶å­˜åœ¨

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# æ£€æŸ¥ç›®å½•æƒé™
ls -la ~/.npm-global/bin/

# ä¿®å¤æƒé™
chmod 755 ~/.npm-global/bin/
chmod 755 ~/.npm-global/bin/*

# æ£€æŸ¥ç”¨æˆ·ç»„
groups
```

---

## ğŸ“Š ä¸åŒæ–¹æ¡ˆå¯¹æ¯”

| æ–¹æ¡ˆ | å®‰å…¨æ€§ | æ˜“ç”¨æ€§ | æ¨èåº¦ | é€‚ç”¨åœºæ™¯ |
|------|--------|--------|--------|----------|
| sudo | â­â­ | â­â­â­â­â­ | â­â­ | ä¸´æ—¶è§£å†³ï¼Œå¼€å‘ç¯å¢ƒ |
| æ›´æ”¹è·¯å¾„ | â­â­â­â­â­ | â­â­â­â­ | â­â­â­â­â­ | é•¿æœŸä½¿ç”¨ï¼Œæ¨èæ–¹æ¡ˆ |
| NVM | â­â­â­â­â­ | â­â­â­ | â­â­â­â­ | å¤šç‰ˆæœ¬ç®¡ç†ï¼Œä¸“ä¸šå¼€å‘ |

---

## ğŸ¯ æœ€ä½³å®è·µå»ºè®®

1. **ä¼˜å…ˆä½¿ç”¨æ–¹æ¡ˆäºŒ**ï¼ˆæ›´æ”¹å…¨å±€åŒ…è·¯å¾„ï¼‰ï¼Œè¿™æ˜¯æœ€å®‰å…¨å’Œæ¨èçš„è§£å†³æ–¹æ¡ˆ
2. **é¿å…ä½¿ç”¨ sudo**ï¼Œé™¤éåœ¨ç‰¹æ®Šæƒ…å†µä¸‹ä¸´æ—¶ä½¿ç”¨
3. **è€ƒè™‘ä½¿ç”¨ NVM**ï¼Œç‰¹åˆ«æ˜¯éœ€è¦ç®¡ç†å¤šä¸ª Node.js ç‰ˆæœ¬æ—¶
4. **å®šæœŸæ¸…ç†**ä¸éœ€è¦çš„å…¨å±€åŒ…ä»¥ä¿æŒç¯å¢ƒæ•´æ´
5. **ä½¿ç”¨é¡¹ç›®çº§ä¾èµ–**ï¼Œé¿å…ä¸å¿…è¦çš„å…¨å±€å®‰è£…

---

## ğŸ”„ ç¯å¢ƒè¿ç§»æŒ‡å—

å¦‚æœä½ éœ€è¦è¿ç§»ç°æœ‰çš„ npm ç¯å¢ƒï¼š

```bash
# 1. å¤‡ä»½å½“å‰å…¨å±€åŒ…åˆ—è¡¨
npm list -g --depth=0 > ~/global-packages.txt

# 2. å¸è½½æ‰€æœ‰å…¨å±€åŒ…ï¼ˆä» sudo æ¨¡å¼ï¼‰
sudo npm uninstall -g $(cat ~/global-packages.txt | tail -n +2 | awk '{print $2}')

# 3. é…ç½®æ–°çš„ npm è·¯å¾„
npm config set prefix '~/.npm-global'
echo 'export PATH=~/.npm-global/bin:$PATH' >> ~/.bashrc
source ~/.bashrc

# 4. é‡æ–°å®‰è£…å…¨å±€åŒ…
xargs npm install -g < ~/global-packages.txt
```

---

## ğŸ“š ç›¸å…³èµ„æº

- [npm å®˜æ–¹æ–‡æ¡£](https://docs.npmjs.com/)
- [NVM å®˜æ–¹ä»“åº“](https://github.com/nvm-sh/nvm)
- [Node.js å®˜ç½‘](https://nodejs.org/)
- [npm æœ€ä½³å®è·µæŒ‡å—](https://docs.npmjs.com/misc/coding-style)

---

## ğŸ‰ æ€»ç»“

é€šè¿‡æœ¬æ–‡ä»‹ç»çš„å¤šç§è§£å†³æ–¹æ¡ˆï¼Œä½ åº”è¯¥èƒ½å¤Ÿå½»åº•è§£å†³ npm æƒé™é—®é¢˜ï¼š

âœ… **æ–¹æ¡ˆä¸€ï¼ˆsudoï¼‰** - å¿«é€Ÿä½†ä¸æ¨èé•¿æœŸä½¿ç”¨
âœ… **æ–¹æ¡ˆäºŒï¼ˆæ›´æ”¹è·¯å¾„ï¼‰** - æœ€ä½³å®è·µï¼Œå®‰å…¨å¯é 
âœ… **æ–¹æ¡ˆä¸‰ï¼ˆNVMï¼‰** - é€‚åˆå¤šç‰ˆæœ¬ç®¡ç†éœ€æ±‚

**æ¨èå·¥ä½œæµç¨‹**ï¼š
1. é¦–æ¬¡é…ç½®ä½¿ç”¨**æ–¹æ¡ˆäºŒ**è®¾ç½®ç”¨æˆ·çº§åˆ«å…¨å±€åŒ…è·¯å¾„
2. å¦‚éœ€å¤šç‰ˆæœ¬æ”¯æŒï¼Œå®‰è£…å¹¶ä½¿ç”¨**NVM**
3. åªåœ¨ç´§æ€¥æƒ…å†µä¸‹ä¸´æ—¶ä½¿ç”¨**sudo**æ–¹æ¡ˆ

è¿™æ ·é…ç½®åï¼Œä½ å°†è·å¾—ä¸€ä¸ªå®‰å…¨ã€é«˜æ•ˆã€æ— æƒé™é—®é¢˜çš„ Node.js å¼€å‘ç¯å¢ƒï¼

---

**ğŸš€ å¼€å§‹äº«å—æ— æƒé™å›°æ‰°çš„ npm å¼€å‘ä½“éªŒå§ï¼**